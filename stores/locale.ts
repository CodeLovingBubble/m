import { defineStore } from "pinia";

// 明确导出 Locale 类型以便其他地方使用
export type Locale = "zh-CN" | "zh-TW" | "en";

interface LanguageOption {
  code: Locale;
  text: string;
}

interface Messages {
  [key: string]: string;
}

export const useLocaleStore = defineStore("locale", {
  state: () => ({
    currentLocale: "zh-CN" as Locale,
    messages: {
      "zh-CN": {
        welcome: "欢迎",
        agreement: "用户协议",
        privacy: "隐私政策",
        help: "帮助中心",
        account: "小米账号",
        login: "登录",
        register: "注册",
        emailOrPhone: "邮箱/手机号码/小米ID",
        password: "密码",
        agreementText: "已阅读并同意小米账号使用协议和隐私政策",
        forgotPassword: "忘记密码？",
        phoneLogin: "手机号登录",
        otherLoginMethods: "其他方式登录",
        privacyPolicyConfirmation: "隐私政策确认",
        privacyPolicyText: "请阅读并同意我们的隐私政策和使用条款以继续登录。",
        cancel: "取消",
        agreeAndContinue: "同意并继续",
        countryRegion: "国家/地区",
        china: "中国",
        countryCode: "国家码",
        phoneNumber: "手机号",
        enterVerificationCode: "请输入验证码",
        getVerificationCode: "获取验证码",
        retryAfter: "后重试",
        noVerificationCode: "收不到验证码？",
        phoneRequired: "请输入手机号",
        copyright:
          "小米公司版权所有-京ICP备10046444-京公网安备11010802020134号-京ICP证110507号",
        setNickname: "请设置昵称",
        accountAndSecurity: "账号与安全",
        personalInfo: "个人信息",
        privacyCenter: "隐私中心",
        bindingAuthorization: "绑定授权",
        helpCenter: "帮助中心",
        loginMethods: "登录方式",
        securityPhone: "安全手机",
        securityEmail: "安全邮箱",
        changePassword: "修改密码",
        thirdPartyAccounts: "第三方账号",
        accountSecurity: "账号安全",
        securityQuestions: "密保问题",
        loginDeviceManagement: "登录设备管理",
        notSet: "未设置",
        personalInformation: "个人信息",
        avatar: "头像",
        nickname: "昵称",
        gender: "性别",
        xiaomiID: "小米ID",
        birthDate: "出生日期",
        edit: "编辑",
        xiaomiAccountSecurityVerification: "小米账号安全验证",
        securityVerificationDesc: "为确认身份，我们仍需验证您的安全手机",
        verificationCodeInstructions:
          "点击发送验证码按钮，将会发送一条带有验证码的信息至手机",
        sendVerificationCode: "发送验证码",
        phoneOrEmailDisabled: "手机号或邮箱已停用？",
        applyForReset: "去申请重置",
        authorization: "授权",
        authorizationDescription: "您已经授权以下应用访问您的部分账号信息",
        emptyIconAlt: "空状态图标",
        noAuthorizedApps: "授权应用暂无",
        miAccountHelpCenter: "小米账号帮助中心",
        searchPlaceholder: "请输入问题关键词",
        selfService: "自助服务",
        resetPassword: "重置密码",
        accountAppeal: "账号申诉",
        freezeAccount: "冻结账号",
        unfreezeAccount: "解冻账号",
        unblockAccount: "解封账号",
        deleteAccount: "注销账号",
        more: "更多",
        faq: "常见问题",
        modifyInfo: "修改信息",
        forgotAccountQuestion: "忘记账号了，该如何找回？",
        forgotPasswordQuestion: "忘记密码了，如何重置密码？",
        phoneDisabledQuestion: "手机号停用了，如何登录或换绑手机号？",
        appealRejectedQuestion: "申诉不通过怎么办？",
        accountHackedQuestion: "账号被盗了，怎么办？",
        logoutQuestion: "如何退出小米账号？",
      },
      "zh-TW": {
        welcome: "歡迎",
        agreement: "用戶協議",
        privacy: "隱私政策",
        help: "幫助中心",
        account: "小米賬號",
        login: "登入",
        register: "註冊",
        emailOrPhone: "郵箱/手機號碼/小米ID",
        password: "密碼",
        agreementText: "已閱讀並同意小米賬號使用協議和隱私政策",
        forgotPassword: "忘記密碼？",
        phoneLogin: "手機號登入",
        otherLoginMethods: "其他方式登入",
        privacyPolicyConfirmation: "隱私政策確認",
        privacyPolicyText: "請閱讀並同意我們的隱私政策和使用條款以繼續登入。",
        cancel: "取消",
        agreeAndContinue: "同意並繼續",
        china: "中國",
        countryCode: "國家碼",
        phoneNumber: "手機號碼",
        enterVerificationCode: "請輸入驗證碼",
        getVerificationCode: "獲取驗證碼",
        retryAfter: "後重試",
        noVerificationCode: "收不到驗證碼？",
        phoneRequired: "請輸入手機號",
        copyright:
          "小米公司版權所有-京ICP備10046444-京公網安備11010802020134號-京ICP證110507號",
        setNickname: "請設置暱稱",
        accountAndSecurity: "賬號與安全",
        personalInfo: "個人信息",
        privacyCenter: "隱私中心",
        bindingAuthorization: "綁定授權",
        helpCenter: "幫助中心",
        loginMethods: "登入方式",
        securityPhone: "安全手機",
        securityEmail: "安全郵箱",
        changePassword: "修改密碼",
        thirdPartyAccounts: "第三方賬號",
        accountSecurity: "賬號安全",
        securityQuestions: "密保問題",
        loginDeviceManagement: "登入設備管理",
        notSet: "未設置",
        personalInformation: "個人信息",
        avatar: "頭像",
        nickname: "暱稱",
        gender: "性別",
        xiaomiID: "小米ID",
        countryRegion: "國家/地區",
        birthDate: "出生日期",
        edit: "編輯",
        xiaomiAccountSecurityVerification: "小米賬號安全驗證",
        securityVerificationDesc: "為確認身份，我們仍需驗證您的安全手機",
        verificationCodeInstructions:
          "點擊發送驗證碼按鈕，將會發送一條帶有驗證碼的信息至手機",
        sendVerificationCode: "發送驗證碼",
        phoneOrEmailDisabled: "手機號或郵箱已停用？",
        applyForReset: "去申請重置",
        authorization: "授權",
        authorizationDescription: "您已經授權以下應用訪問您的部分賬號信息",
        emptyIconAlt: "空狀態圖標",
        noAuthorizedApps: "授權應用暫無",
        miAccountHelpCenter: "小米賬號幫助中心",
        searchPlaceholder: "請輸入問題關鍵詞",
        selfService: "自助服務",
        resetPassword: "重置密碼",
        accountAppeal: "賬號申訴",
        freezeAccount: "凍結賬號",
        unfreezeAccount: "解凍賬號",
        unblockAccount: "解封賬號",
        deleteAccount: "註銷賬號",
        more: "更多",
        faq: "常見問題",
        modifyInfo: "修改信息",
        forgotAccountQuestion: "忘記賬號了，該如何找回？",
        forgotPasswordQuestion: "忘記密碼了，如何重置密碼？",
        phoneDisabledQuestion: "手機號停用了，如何登入或換綁手機號？",
        appealRejectedQuestion: "申訴不通過怎麼辦？",
        accountHackedQuestion: "賬號被盜了，怎麼辦？",
        logoutQuestion: "如何退出小米賬號？",
      },
      en: {
        welcome: "Welcome",
        agreement: "User Agreement",
        privacy: "Privacy Policy",
        help: "Help Center",
        account: "Xiaomi Account",
        login: "Login",
        register: "Register",
        emailOrPhone: "Email/Phone/Xiaomi ID",
        password: "Password",
        agreementText:
          "I have read and agree to the Xiaomi Account User Agreement and Privacy Policy",
        forgotPassword: "Forgot password?",
        phoneLogin: "Login with phone",
        otherLoginMethods: "Other login methods",
        privacyPolicyConfirmation: "Privacy Policy Confirmation",
        privacyPolicyText:
          "Please read and agree to our Privacy Policy and Terms of Use to continue logging in.",
        cancel: "Cancel",
        agreeAndContinue: "Agree and Continue",
        countryRegion: "Country/Region",
        china: "China",
        countryCode: "Country Code",
        phoneNumber: "Phone Number",
        enterVerificationCode: "Enter verification code",
        getVerificationCode: "Get verification code",
        retryAfter: "retry after",
        noVerificationCode: "Didn't receive code?",
        phoneRequired: "Please enter your mobile phone number",
        copyright:
          "© Xiaomi Inc. All Rights Reserved - ICP No.10046444 - Beijing Public Security No.11010802020134 - Beijing ICP Certificate No.110507",
        setNickname: "Please set nickname",
        accountAndSecurity: "Account & Security",
        personalInfo: "Personal Info",
        privacyCenter: "Privacy Center",
        bindingAuthorization: "Binding Authorization",
        helpCenter: "Help Center",
        loginMethods: "Login Methods",
        securityPhone: "Security Phone",
        securityEmail: "Security Email",
        changePassword: "Change Password",
        thirdPartyAccounts: "Third-party Accounts",
        accountSecurity: "Account Security",
        securityQuestions: "Security Questions",
        loginDeviceManagement: "Login Device Management",
        notSet: "Not Set",
        personalInformation: "Personal Information",
        avatar: "Avatar",
        nickname: "Nickname",
        gender: "Gender",
        xiaomiID: "Xiaomi ID",
        birthDate: "Birth Date",
        edit: "Edit",
        xiaomiAccountSecurityVerification:
          "Xiaomi Account Security Verification",
        securityVerificationDesc:
          "To confirm your identity, we still need to verify your security phone",
        verificationCodeInstructions:
          "Click the send verification code button to send a message with a verification code to your phone",
        sendVerificationCode: "Send Verification Code",
        phoneOrEmailDisabled: "Phone number or email disabled?",
        applyForReset: "Apply for reset",
        authorization: "Authorization",
        authorizationDescription:
          "You have authorized the following apps to access part of your account information",
        emptyIconAlt: "Empty state icon",
        noAuthorizedApps: "No authorized apps",
        miAccountHelpCenter: "Xiaomi Account Help Center",
        searchPlaceholder: "Enter keywords for your question",
        selfService: "Self Service",
        resetPassword: "Reset Password",
        accountAppeal: "Account Appeal",
        freezeAccount: "Freeze Account",
        unfreezeAccount: "Unfreeze Account",
        unblockAccount: "Unblock Account",
        deleteAccount: "Delete Account",
        more: "More",
        faq: "FAQ",
        modifyInfo: "Modify Info",
        forgotAccountQuestion: "Forgot account, how to recover?",
        forgotPasswordQuestion: "Forgot password, how to reset?",
        phoneDisabledQuestion: "Phone disabled, how to login or change number?",
        appealRejectedQuestion: "What if appeal is rejected?",
        accountHackedQuestion: "Account hacked, what to do?",
        logoutQuestion: "How to logout Xiaomi account?",
      },
    } as Record<Locale, Messages>,
  }),

  getters: {
    t:
      (state) =>
      (key: string): string => {
        return state.messages[state.currentLocale][key] || key;
      },

    currentLanguageText(): string {
      const map: Record<Locale, string> = {
        "zh-CN": "中文(简体)",
        "zh-TW": "中文(繁體)",
        en: "English",
      };
      return map[this.currentLocale];
    },

    availableLanguages(): LanguageOption[] {
      const allLanguages: LanguageOption[] = [
        { code: "zh-CN", text: "中文(简体)" },
        { code: "zh-TW", text: "中文(繁體)" },
        { code: "en", text: "English" },
      ];
      return allLanguages.filter((lang) => lang.code !== this.currentLocale);
    },
  },

  actions: {
    setLocale(locale: Locale) {
      this.currentLocale = locale;
      localStorage.setItem("userLocale", locale);
    },

    initLocale() {
      const savedLocale = localStorage.getItem("userLocale");
      if (savedLocale && Object.keys(this.messages).includes(savedLocale)) {
        this.currentLocale = savedLocale as Locale;
      }
    },
  },
});
